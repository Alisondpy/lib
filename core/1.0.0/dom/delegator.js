define(function(t,n,e){"use strict";function o(t,n){var e,o,i,a=n.currentTarget,u=r(a),c=(n.handleObj||0).origType||n.type;if(!n.isPropagationStopped())return!u.attr("disabled")&&(e=u.attr("action-type"))&&(o=u.attr("action-data"),n.action=e,n.data=o,i=t.e.emit(c+f+e,n,a),n.actionValue=i,i===!1&&(n.preventDefault(),n.stopPropagation())),t.opts.onDelegate(n),i}var r=t("jquery"),i=t("../event/emitter"),a=/\S+/g,u=-1,c=(+new Date).toString(36),f="/",l=function(){return c+ ++u},d=function(t,n){var e=t.guid||(t.guid=l()),o=function(e,o){return t.call(n||o,e)};return o.guid=e,o},p=function(){},g=function(t,n){return"function"==typeof t?t:n},v=function(t,n){n=n||{},"string"==typeof t&&(t=r(t)[0]);var e={},u={},c=new i,l=n.context,v={o:e,opts:n,e:c},s=function(t){return o(v,t)};return n.onDelegate=g(n.onDelegate,p),e.on=function(n,e,o){if("function"==typeof e&&(o=e,e=n,n="click"),"function"!=typeof o)throw Error("The delegate handler should be a valid function");e=(e||"").match(a)||[];for(var i=e.length;i--;)u[n]||(u[n]=1,r(t).on(n,"[action-type]",s)),c.on(n+f+e[i],d(o,l));return this},e.un=function(n,e,o){"function"!=typeof e&&e||(o=e,e=n,n="click"),e=(e||"").match(a)||[];var i,u=e.length;for(r(t);u--;)i=n+f+e[u],c.un(i,o);return this},e.fire=function(n,e){e||(e=n,n="click");var o=r('[action-type="'+e+'"]',t)[0]||document,i=new r.Event(n);i.currentTarget=i.target=o,c.emit(n+f+e,i,o)},e.destroy=function(){var o=r(t);r.each(u,function(t,n){delete u[t],o.off(t,"[action-type]",s)}),c.un();for(var i in e)delete e[i];c=void 0,n=void 0,u=o=t=void 0,s=null},e};e.exports=v});