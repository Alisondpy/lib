define(function(e,t,n){"use strict";function r(e,t,n,r){r?e[t]||(e[t]=n):e[t]?e[t]=e[t].add(n):e[t]=i(n)}var o=window.document,i=e("jquery"),a=function(e,t,n){var a,d,l,f,u,c=function(e){if(n)for(var o in n)l[o]=i(n[o].toString(),e);else{l={},f=i("[node-type]",e);for(var a,d=-1,u=f.length;++d<u;)a=f[d],o=a.getAttribute("node-type"),r(l,o,a,t)}},p=function(e){var n,o=l[e];return o&&0!==o.length||(n=i('[node-type="'+e+'"]',a),n.length&&r(l,e,n,t),o=l[e]),o};if(void 0===t&&(t=!0),a=e,"string"==typeof e&&"<"===e.charAt(0))for(a=o.createElement("div"),a.innerHTML=e,d=o.createDocumentFragment();u=a.firsChild;)d.appendChild(u);else a=i(e),d=a[0];return c(a),{get:p,box:d,list:l}};t.build=a,t.parse=function(e,t,n){if("object"==typeof e&&e.length>0&&(e=e[0]),!e||1!==e.nodeType)throw TypeError("parse error, not a valid html element");return"boolean"==typeof n&&(t=n,n=null),a(e,t,n).list},t.dataset=e("./dataset")});