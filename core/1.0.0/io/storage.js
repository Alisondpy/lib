!function(t){"use strict";function e(t,e){var n=this;n.name=t,n.adapter=e,n.data=e.load(t),n.expires={},l.add(n,function(){var t=(new Date).getTime(),e=n.expires;for(var r in e)e[r]<t&&(delete n.data[r],delete e[r])})}var n=[].slice,r=t.JSON,i=!!t.localStorage&&!!(r&&r.parse&&r.stringify),s=t.localStorage||{},o=t.sessionStorage||{},u=function(){return(u=r.parse).apply(r,arguments)},a=function(){return(a=r.stringify).apply(r,arguments)},h=function(){var t=function(t){this.constructor=t};return function(e,n){t.prototype=n,e.prototype=new t(e)}}(),l=function(){function t(){u=!0;for(var t,e=a.length,n=-1;++n<e;)t=a[n],t.fn.call(t.target,n)}function e(){a.length?(t(),o=setTimeout(e,6e4)):n()}function n(){u&&(clearTimeout(o),u=!1,o=null)}function r(){u||e()}function i(t,e){var n=t.name;h[n]={id:n,target:t,fn:e},a.push(h[n]),r()}function s(t){for(var e=a.length;e--;)a[e].target===t&&a.splice(e,1);delete h[t.name],a.length||n()}var o=null,u=!1,a=[],h={};return{add:i,remove:s,stop:n}}();h(e,{store:function(){this.adapter.store(this.name,this.data)},toString:function(){return a(this.data)},flushdb:function(){var t=this;return this.data={},this.expires={},setTimeout(function(){t.store()},0),!0},get:function(t,e){return void 0!==this.data[t]?this.data[t]:e},set:function(t,e){this.data[t]=e,this.store()},setex:function(t,e,n){this.set(t,n),this.expire(t,e)},expire:function(t,e){this.data[t]&&(this.expires[t]=(new Date).getTime()+1e3*e)},exists:function(t){var e="__N/A__";return this.get(t,e)!==e},del:function(){for(var t=n.call(arguments),e=null,r=0,i=0;i<t.length;i++)e=t[i],this.exists(e)&&(delete this.data[e],this.expires[e]&&delete this.expires[e],r++);return this.store(),r},type:function(t){return t=this.get(t),"object"==typeof t?"["===a(t)[0]?"list":"set":typeof t},append:function(t,e){e=String(e);var n=String(this.get(t,"")),r=n+e;return this.set(t,r),r.length},incr:function(t,e){e=e||1;var n=Number(this.get(t,0)),r=n+e;return this.set(t,r),r},decr:function(t,e){return e=e||1,this.incr(t,e*-1)},llen:function(t){return this.get(t,[]).length},lpush:function(t,e){var n=this.get(t,[]),r=n.unshift(e);return this.set(t,n),r},rpush:function(t,e){var n=this.get(t,[]),r=n.push(e);return this.set(t,n),r},lset:function(t,e,n){var r=this.get(t,[]);return e<0&&(e=r.length-Math.abs(e)),!!r[e]&&(r[e]=n,this.set(t,r),!0)},lindex:function(t,e){var n=this.get(t,[]);return e<0&&(e=n.length-Math.abs(e)),n[e]?n[e]:null},hset:function(t,e,n){var r=this.get(t,{});r[e]=n,this.set(t,r)},hget:function(t,e,n){var r=this.get(t,{});return void 0!==r[e]?r[e]:n},hgetall:function(t){return this.get(t,{})},hexists:function(t,e){var n=this.get(t,{});return void 0!==n[e]},hkeys:function(t){var e=this.get(t,{}),n=[],r=null;for(r in e)e.hasOwnProperty(r)&&n.push(r);return n},hvals:function(t){var e=this.get(t,{}),n=[],r=null;for(r in e)e.hasOwnProperty(r)&&n.push(e[r]);return n},hlen:function(t){return this.hkeys(t).length},hdel:function(t){if(!this.exists(t))return 0;for(var e=this.get(t,{}),r=null,i=0,s=n.call(arguments),o=1;o<s.length;o++)r=s[o],void 0!==e[r]&&(delete e[r],i++);return this.set(t,e),i},hincrby:function(t,e,n){n=n||1;var r=Number(this.hget(t,e,0)),i=r+n;return this.hset(t,e,i),i},hmget:function(t){for(var e=this.get(t,{}),r=null,i=[],s=n.call(arguments),o=1;o<s.length;o++)r=s[o],i.push(void 0!==e[r]?e[r]:null);return i},hmset:function(t){for(var e=this.get(t,{}),r=null,i=null,s=n.call(arguments),o=1;o<s.length;o++)r=s[o],i=s[o+1]?s[o+1]:null,e[r]=i,o+=1;this.set(t,e)},destroy:function(){l.remove(this),this.adapter=null,this.data=null,this.expires=null}});var f={select:function(){var t={};return function(n,r){r=r||"memory";var i=n+"$"+r,s=this.adapters;return t[i]||(t[i]=new e(n,s[r]||s.memory))}}(),adapters:{memory:function(){var t={};return{load:function(e){return t[e]||{}},store:function(e,n){t[e]=n}}}(),local:i&&{load:function(t){return s["storage/"+t]?u(s["storage/"+t]):{}},store:function(t,e){s["storage/"+t]=a(e)}},session:i&&{load:function(t){return o["storage/"+t]?u(o["storage/"+t]):{}},store:function(t,e){o["storage/"+t]=a(e)}}}};"function"==typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=f),exports.Storage=f):t.Storage=f}(this);