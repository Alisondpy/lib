!function(t,e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module)e(require,module.exports,module);else{var n={exports:{}};e(null,n.exports,n),t.EventEmitter=n.exports}}(this,function(t,e,n){"use strict";function r(){}function i(t,e,n,r){var i=!0;if(e)for(var o,u,f,s=-1,c={type:t,timeStamp:l()};o=e[++s];){u=o[v],f=o[y]||r;try{i=o[m]===d?u.call(f,c,n)!==!1&&i:u.apply(f,n)!==!1&&i}catch(t){setTimeout(function(){console.error(t)},1)}}return i}function o(t){var e,n=p(this);return n?(e=n[t],e.length):0}function u(t){return"[object Function]"===Object.prototype.toString.call(t)}function f(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)}function s(t,e){t.forEach?t.forEach(e):function(t){for(var n=-1,r=t.length;++n<r;)e(t[n],n)}(t)}var c=/\s+/,l=Date.now||function(){return+new Date},a=function(){return l()*Math.random()&65535}(),p=function(){var t,e,n;return"function"==typeof WeakMap&&(WeakMap.prototype||0).set?(t=new WeakMap,function(e,n){var r=t.get(e);return null===n?void 0!==r&&t.delete(e):!r&&n?(t.set(e,r={}),r):r}):(e=l(),n="__$widÎ¦"+e.toString(36),t={},function(r,i){if(!r||"object"!=typeof r)throw TypeError("Invalid value used as weak map key");var o;return null===i?r[n]&&(delete t[r[n]],delete r[n]):(o=r[n]||i&&(o=++e,t[o]={},r[n]=o),o&&t[o])})}(),h=1,d=2,v=0,y=1,m=2,g=function(t,e,n){var r=[];return r[v]=t,r[y]=e,r[m]=n,r},w=r.prototype;w.addListener=function(t,e,n,r){var i,o,u,f=h;if(e&&"object"==typeof e&&(n=e,e=n.handleEvent,f=d),!e)return this;for(i=p(this,1),t=t.split(c);o=t.shift();)u=!r&&i[o]||(i[o]=[]),u.push(g(e,n,f));return this},w.on=w.addListener,w.once=function(t,e,n){var r=!1,i=function(){this.removeListener(t,i),r||(r=!0,e.apply(n||this,arguments))};return i.guid=e.guid||(e.guid=a++),this.on(t,i)},w.removeListener=function(t,e,n){var r,i,o,u,s,l;if(e&&"object"==typeof e&&(n=e,e=n.handleEvent),!(r=p(this)))return this;if(!(t||e||n))return f(r,function(t,e){delete r[e]}),p(this,null),this;for(t=t?t.split(c):E(r);i=t.shift();)if(o=r[i])if(e||n)for(u=o.length;--u>=0;)s=o[u],l=s[v],e&&l!==e&&(void 0===l.guid||l.guid!==e.guid)||n&&s[y]!==n||o.splice(u,1);else delete r[i];return this},w.un=w.removeListener,w.removeAllListeners=function(t){return this.removeListener(t)},w.emit=function(t){var e,n,r,o,u,f,s=[],l=!0;if(!(e=p(this)))return this;for(t=t.split(c),u=1,f=arguments.length;u<f;u++)s[u-1]=arguments[u];for(;n=t.shift();)(r=e.all)&&(r=r.slice()),(o=e[n])&&(o=o.slice()),"all"!==n&&(l=i(n,o,s,this)&&l),l=i(n,r,[n].concat(s),this)&&l;return l},r.applyTo=function(t){function e(e,r){t[e]=function(){var i=n[e].apply(r||t,Array.prototype.slice.call(arguments));return i===r?this:i}}var n=w,r=E(n);u(t)?s(r,function(e){t.prototype[e]=n[e]}):s(r,function(t){e(t)})},r.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):o.call(t,e)},w.listenerCount=o;var E=Object.keys||function(t){var e=[];return f(t,function(t,n){e.push(n)}),e};n.exports=r});