define(function(e,n,i){"use strict";function r(e,n){if(e.indexOf)return e.indexOf(n)!==-1;for(var i=-1,r=e.length;++i<r;)if(e[i]===n)return!0;return!1}var t=e("../utils/util"),l=e("./emitter"),o={},f=function(e,n){if(!e)throw Error("Defines listener failed. listener name cannot null");var i=o[e];if(i)throw Error("Create listener with name '"+e+"' failed. listener exists");var f=new l,s=[],u=[],a=0,c={init:function(n){if(a)throw Error("Initialize listener with name '"+e+"' failed. listener alreay initialized");a=1,s=n;for(var i;i=u.shift();)r(n,i[0])&&c.listen.apply(c,i);return c},listen:function(n,i,t){var l=[].slice.call(arguments);if(a){if(!r(s,n))throw Error("The event type '"+n+"' in ["+e+"] is unrecognized, check whitelist first");f.on.apply(f,l)}else u.push(l)},fire:function(e){if(!a)throw Error("Notify listener ignored, The listener not ready yet");f.emit.apply(f,arguments)},destroy:function(){f.removeAllListeners(),f=null,s=u=c=null,delete o[e]}};return t.each(["once","un"],function(e){c[e]=function(){return f[e].apply(f,arguments)}}),c.on=c.listen,n&&c.init(n),o[e]=c,c},s=function(e){var n=e&&o[e];return!!n&&(n.destroy(),!0)};i.exports={define:f,undefine:s,get:function(e){return o[e]}}});