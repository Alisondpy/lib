define(function(n,t,e){"use strict";var r=n("./animation-frame"),i=window,f=Date.now||function(){return+new Date},o=r.next,u=r.cancel,c=function(){function n(e){if(v.length){if(!p)return;for(var r,i,u,c,l,s,h=v.slice(0);r=h.shift();)c=f(),i=r[1],l=r[2],s=r[3],u=r[4],c-u>=i&&(r[4]=c,s?l.apply(null,s):l(e));p&&(a=o(n))}else t()}function t(){p&&(u(a),p=!1,a=null)}function e(){p||(p=!0,i.setTimeout(n,1))}function r(n,t,r){if("function"!=typeof n)return 0;!r||"object"==typeof r&&r.length||(r=void 0),t=+t||0;for(var i,o=-1;i=v[++o];)if(i[1]===t&&i[2]===n&&i[3]===r)return i[0];var u=++s;return v.push([u,t,n,r,f()]),e(),u}function c(n){if(n){for(var e=v.length;e--;)if(v[e][0]===n){v.splice(e,1);break}v.length||t()}}function l(n,t,e){var i=r(function(){c(i),n.apply(null,arguments)},t,e);return i}var a,p,s=0,v=[];return{loop:r,delay:l,cancel:c}}();e.exports=c});