define(function(t,e,o){"use strict";function n(t){var e=this,o={tabs:[{type:"local",options:{uploadLimit:0,swf:"/uploadify.swf",uploader:"/Upload/images/"}},{type:"network",options:{}},{type:"album",options:{}}],limit:0,selected:[]};e._options=t=i.extend({},o,t),e.el=i(e._make());var n=s.create({content:e.el[0],className:"ui-uploader-box",title:"图片选择"});e.box=n,e.box.once("shown",function(){e.activateTab(e.tabs[0])}),e._nodes=c.parse(e.el,!1),e.tabs=[],e._initTabs();var a=new d({limit:e._options.limit,selected:e._options.selected});e._nodes.selected.append(a.el),e.selected=a,e._onEvent()}t("css!./css/uploader.css");var i=t("jquery"),a=t("lib/core/1.0.0/event/emitter"),s=t("lib/ui/box/1.0.1/box"),l=t("lib/core/1.0.0/utils/util"),c=t("lib/core/1.0.0/dom/build"),r={};r.local=t("./tabs/local/local"),r.network=t("./tabs/network/network"),r.album=t("./tabs/album/album");var d=t("./selected/selected");l.inherits(n,a),n._id=0,n.prototype.activateTab=function(t){for(var e=this,o=e.tabs,n=0,i=o.length;n<i;n++)t===o[n]?e.tabs[n].activate():e.tabs[n].deactivate();return this},n.prototype._initTabs=function(){for(var t,e=this,o=e._options.tabs,n=0,i=o.length;n<i;n++)t=new r[o[n].type](o[n].options),e.addTab(t)},n.prototype.addTab=function(t){var e=this,o=e._isExistTab(t);return o||(e._nodes["tab-title"].append(t.title),e._nodes["tab-container"].append(t.container),e.tabs.push(t)),this},n.prototype._isExistTab=function(t){for(var e=this,o=e.tabs,n=0,i=o.length;n<i;n++)if(o[n]===t)return!0;return!1},n.prototype.$=function(t,e){var o=this._nodes||(this._nodes={}),n=o[t];return(!n||e&&0===n.length)&&(n=this.el.find('[node-type="'+t+'"]'),e&&n.length>0&&(o[t]=n)),!e||n.length?n:null},n.prototype._onEvent=function(){for(var t=this,e=t.tabs,o=0,n=e.length;o<n;o++)!function(o){e[o].title.on("click",function(){t.activateTab(e[o])}),e[o].on("add",function(e){t.selected.add(e)})}(o);t._nodes["btn-ok"].on("click",function(){t.emit("ok",t.selected.getUrls())}),t._nodes["btn-cancel"].on("click",function(){t.hide()})},n.prototype._offEvent=function(){for(var t=this,e=t.tabs,o=0,n=e.length;o<n;o++)e[o].title.off("click");t._nodes["btn-ok"].off("click"),t._nodes["btn-cancel"].off("click")},n.prototype.show=function(){var t=this;return t.box.show(),this},n.prototype.hide=function(){var t=this;return t.destroy(),this},n.prototype.destroy=function(){var t=this;return t._offEvent(),t.box.hide(),this},n.prototype._make=function(){var t="";return t+='<div class="ui-uploader">',t+='    <div class="uploader-main clearfix">',t+='        <div class="uploader-tab">',t+='            <ul class="tab-title" node-type="tab-title">',t+="            </ul>",t+='            <div class="tab-container" node-type="tab-container">',t+="            </div>",t+="        </div>",t+='        <div class="selected-box" node-type="selected">',t+="        </div>",t+="    </div>",t+='    <div class="uploader-bottom">',t+='        <div class="tips" node-type="tips">copyright zhongzhihui.com</div>',t+='        <div class="btns">',t+='            <a class="btn btn-primary" node-type="btn-ok" href="javascript:;">确定</a>',t+='            <a class="btn btn-default" node-type="btn-cancel" href="javascript:;">取消</a>',t+="        </div>",t+="    </div>",t+="</div>"},o.exports=n});