!function(r,t){"object"==typeof exports?module.exports=t(r,require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(o){return t(r,o)}):t(r,r.jQuery)}(this,function(r,t,o){"use strict";function e(r){return r.value||r.getAttribute("value")||t(r).css("background-color")||"#fff"}function i(r){return r=r.originalEvent&&r.originalEvent.touches?r.originalEvent.touches[0]:r,r.originalEvent?r.originalEvent:r}function n(r){return t(r.find(x.doRender)[0]||r[0])}function s(r){var o,e,i=/\d/,n=document.body;do{if(o=t(r),"static"!==o.css("position")&&i.test(e=o.css("zIndex")))return(parseInt(e)||-1)+1;if(r===n)break}while(r=r.parentNode);return 0}function c(o){var i=t(this),c=i.offset(),u=t(r),h=x.gap;o?(m=n(i),m._colorMode=m.data("colorMode"),b.$trigger=i,(y||a()).css({left:(y._left=c.left)-((y._left+=y._width-(u.scrollLeft()+u.width()))+h>0?y._left+h:0),top:(y._top=c.top+i.outerHeight())-((y._top+=y._height-(u.scrollTop()+u.height()))+h>0?y._top+h:0),"z-index":s(this)}).show(x.animationSpeed,function(){o!==!0&&(B.toggle(!!x.opacity)._width=B.width(),k._width=k.width(),k._height=k.height(),_._height=_.height(),v.setColor(e(m[0])),g(!0))}).off(".tcp").on(H,".cp-xy-slider,.cp-z-slider,.cp-alpha",l)):b.$trigger&&t(y).hide(x.animationSpeed,function(){g(!1),b.$trigger=null}).off(".tcp")}function a(){return t("head").append('<style type="text/css" id="tinyColorPickerStyles">'+(x.css||S)+(x.cssAddon||"")+"</style>"),t($).css({margin:x.margin}).appendTo("body").show(0,function(){b.$UI=y=t(this),F=x.GPU&&y.css("perspective")!==o,_=t(".cp-z-slider",this),k=t(".cp-xy-slider",this),w=t(".cp-xy-cursor",this),C=t(".cp-z-cursor",this),B=t(".cp-alpha",this),G=t(".cp-alpha-cursor",this),x.buildCallback.call(b,y),y.prepend("<div>").children().eq(0).css("width",y.children().eq(0).width()),y._width=this.offsetWidth,y._height=this.offsetHeight}).hide()}function l(r){var o=this.className.replace(/cp-(.*?)(?:\s*|$)/,"$1").replace("-","_");(r.button||r.which)>1||(r.preventDefault&&r.preventDefault(),r.returnValue=!1,m._offset=t(this).offset(),(o="xy_slider"===o?u:"z_slider"===o?h:p)(r),g(),R.on(D,function(r){R.off(".tcp")}).on(E,function(r){o(r),g()}))}function u(r){var t=i(r),o=t.pageX-m._offset.left,e=t.pageY-m._offset.top;v.setColor({s:o/k._width*100,v:100-e/k._height*100},"hsv")}function h(r){var t=i(r).pageY-m._offset.top;v.setColor({h:360-t/_._height*360},"hsv")}function p(r){var t=i(r).pageX-m._offset.left,o=t/B._width;v.setColor({},"rgb",o)}function g(r){var t=v.colors,e=t.hueRGB,i=(t.RND.rgb,t.RND.hsl,x.dark),n=x.light,s=v.toString(m._colorMode,x.forceAlpha),c=t.HUELuminance>.22?i:n,a=t.rgbaMixBlack.luminance>.22?i:n,l=(1-t.hsv.h)*_._height,u=t.hsv.s*k._width,h=(1-t.hsv.v)*k._height,p=t.alpha*B._width,g=F?"translate3d":"",d=m[0].value,b=m[0].hasAttribute("value")&&""===d&&r!==o;k._css={backgroundColor:"rgb("+e.r+","+e.g+","+e.b+")"},w._css={transform:g+"("+u+"px, "+h+"px, 0)",left:F?"":u,top:F?"":h,borderColor:t.RGBLuminance>.22?i:n},C._css={transform:g+"(0, "+l+"px, 0)",top:F?"":l,borderColor:"transparent "+c},B._css={backgroundColor:"#"+t.HEX},G._css={transform:g+"("+p+"px, 0, 0)",left:F?"":p,borderColor:a+" transparent"},m._css={backgroundColor:b?"":s,color:b?"":t.rgbaMixBGMixCustom.luminance>.22?i:n},m.text=b?"":d!==s?s:"",r!==o?f(r):X(f)}function f(r){k.css(k._css),w.css(w._css),C.css(C._css),B.css(B._css),G.css(G._css),x.doRender&&m.css(m._css),m.text&&m.val(m.text),x.renderCallback.call(b,m,"boolean"==typeof r?r:o)}function d(){}var b,v,x,m,y,_,k,w,C,B,G,M=function(r,t){function o(r,o,e,n,s){if("string"==typeof o){var o=_.txt2color(o);e=o.type,d[e]=o[e],s=s!==t?s:o.alpha}else if(o)for(var c in o)r[e][c]=u(o[c]/h[e][c][1],0,1);return s!==t&&(r.alpha=u(+s,0,1)),i(e,n?r:t)}function e(r,t,o){var e=f.options.grey,i={};return i.RGB={r:r.r,g:r.g,b:r.b},i.rgb={r:t.r,g:t.g,b:t.b},i.alpha=o,i.equivalentGrey=g(e.r*r.r+e.g*r.g+e.b*r.b),i.rgbaMixBlack=a(t,{r:0,g:0,b:0},o,1),i.rgbaMixWhite=a(t,{r:1,g:1,b:1},o,1),i.rgbaMixBlack.luminance=c(i.rgbaMixBlack,!0),i.rgbaMixWhite.luminance=c(i.rgbaMixWhite,!0),f.options.customBG&&(i.rgbaMixCustom=a(t,f.options.customBG,o,1),i.rgbaMixCustom.luminance=c(i.rgbaMixCustom,!0),f.options.customBG.luminance=c(f.options.customBG,!0)),i}function i(r,t){var o,i,u,b=t||d,v=_,x=f.options,m=h,y=b.RND,k="",w="",C={hsl:"hsv",rgb:r},B=y.rgb;if("alpha"!==r){for(var G in m)if(!m[G][G]){r!==G&&(w=C[G]||"rgb",b[G]=v[w+"2"+G](b[w])),y[G]||(y[G]={}),o=b[G];for(k in o)y[G][k]=g(o[k]*m[G][k][1])}B=y.rgb,b.HEX=v.RGB2HEX(B),b.equivalentGrey=x.grey.r*b.rgb.r+x.grey.g*b.rgb.g+x.grey.b*b.rgb.b,b.webSave=i=n(B,51),b.webSmart=u=n(B,17),b.saveColor=B.r===i.r&&B.g===i.g&&B.b===i.b?"web save":B.r===u.r&&B.g===u.g&&B.b===u.b?"web smart":"",b.hueRGB=_.hue2RGB(b.hsv.h),t&&(b.background=e(B,b.rgb,b.alpha))}var M,R,z,E=b.rgb,H=b.alpha,D="luminance",F=b.background;return M=a(E,{r:0,g:0,b:0},H,1),M[D]=c(M,!0),b.rgbaMixBlack=M,R=a(E,{r:1,g:1,b:1},H,1),R[D]=c(R,!0),b.rgbaMixWhite=R,x.customBG&&(z=a(E,F.rgbaMixCustom,H,1),z[D]=c(z,!0),z.WCAG2Ratio=l(z[D],F.rgbaMixCustom[D]),b.rgbaMixBGMixCustom=z,z.luminanceDelta=p.abs(z[D]-F.rgbaMixCustom[D]),z.hueDelta=s(F.rgbaMixCustom,z,!0)),b.RGBLuminance=c(B),b.HUELuminance=c(b.hueRGB),x.convertCallback&&x.convertCallback(b,r),b}function n(r,t){var o={},e=0,i=t/2;for(var n in r)e=r[n]%t,o[n]=r[n]+(e>i?t-e:-e);return o}function s(r,t,o){return(p.max(r.r-t.r,t.r-r.r)+p.max(r.g-t.g,t.g-r.g)+p.max(r.b-t.b,t.b-r.b))*(o?255:1)/765}function c(r,t){for(var o=t?1:255,e=[r.r/o,r.g/o,r.b/o],i=f.options.luminance,n=e.length;n--;)e[n]=e[n]<=.03928?e[n]/12.92:p.pow((e[n]+.055)/1.055,2.4);return i.r*e[0]+i.g*e[1]+i.b*e[2]}function a(r,o,e,i){var n={},s=e!==t?e:1,c=i!==t?i:1,a=s+c*(1-s);for(var l in r)n[l]=(r[l]*s+o[l]*c*(1-s))/a;return n.a=a,n}function l(r,t){var o=1;return o=r>=t?(r+.05)/(t+.05):(t+.05)/(r+.05),g(100*o)/100}function u(r,t,o){return r>o?o:r<t?t:r}var h={rgb:{r:[0,255],g:[0,255],b:[0,255]},hsv:{h:[0,360],s:[0,100],v:[0,100]},hsl:{h:[0,360],s:[0,100],l:[0,100]},alpha:{alpha:[0,1]},HEX:{HEX:[0,16777215]}},p=r.Math,g=p.round,f={},d={},b={r:.298954,g:.586434,b:.114612},v={r:.2126,g:.7152,b:.0722},x=function(r){this.colors={RND:{}},this.options={color:"rgba(0,0,0,0)",grey:b,luminance:v,valueRanges:h},m(this,r||{})},m=function(r,e){var i,n=r.options;y(r);for(var s in e)e[s]!==t&&(n[s]=e[s]);i=n.customBG,n.customBG="string"==typeof i?_.txt2color(i).rgb:i,d=o(r.colors,n.color,t,!0)},y=function(r){f!==r&&(f=r,d=r.colors)};x.prototype.setColor=function(r,e,n){return y(this),r?o(this.colors,r,e,t,n):(n!==t&&(this.colors.alpha=u(n,0,1)),i(e))},x.prototype.setCustomBackground=function(r){return y(this),this.options.customBG="string"==typeof r?_.txt2color(r).rgb:r,o(this.colors,t,"rgb")},x.prototype.saveAsBackground=function(){return y(this),o(this.colors,t,"rgb",!0)},x.prototype.toString=function(r,t){return _.color2text((r||"rgb").toLowerCase(),this.colors,t)};var _={txt2color:function(r){var t={},o=r.replace(/(?:#|\)|%)/g,"").split("("),e=(o[1]||"").split(/,\s*/),i=o[1]?o[0].substr(0,3):"rgb",n="";if(t.type=i,t[i]={},o[1])for(var s=3;s--;)n=i[s]||i.charAt(s),t[i][n]=+e[s]/h[i][n][1];else t.rgb=_.HEX2rgb(o[0]);return t.alpha=e[3]?+e[3]:1,t},color2text:function(r,t,o){var e=o!==!1&&g(100*t.alpha)/100,i="number"==typeof e&&o!==!1&&(o||1!==e),n=t.RND.rgb,s=t.RND.hsl,c="hex"===r&&i,a="hex"===r&&!c,l="rgb"===r||c,u=l?n.r+", "+n.g+", "+n.b:a?"#"+t.HEX:s.h+", "+s.s+"%, "+s.l+"%";return a?u:(c?"rgb":r)+(i?"a":"")+"("+u+(i?", "+e:"")+")"},RGB2HEX:function(r){return((r.r<16?"0":"")+r.r.toString(16)+(r.g<16?"0":"")+r.g.toString(16)+(r.b<16?"0":"")+r.b.toString(16)).toUpperCase()},HEX2rgb:function(r){return r=r.split(""),{r:+("0x"+r[0]+r[r[3]?1:0])/255,g:+("0x"+r[r[3]?2:1]+(r[3]||r[1]))/255,b:+("0x"+(r[4]||r[2])+(r[5]||r[2]))/255}},hue2RGB:function(r){var t=6*r,o=~~t%6,e=6===t?0:t-o;return{r:g(255*[1,1-e,0,0,e,1][o]),g:g(255*[e,1,1,1-e,0,0][o]),b:g(255*[0,0,e,1,1,1-e][o])}},rgb2hsv:function(r){var t,o,e,i=r.r,n=r.g,s=r.b,c=0;return n<s&&(n=s+(s=n,0),c=-1),o=s,i<n&&(i=n+(n=i,0),c=-2/6-c,o=p.min(n,s)),t=i-o,e=i?t/i:0,{h:e<1e-15?d&&d.hsl&&d.hsl.h||0:t?p.abs(c+(n-s)/(6*t)):0,s:i?t/i:d&&d.hsv&&d.hsv.s||0,v:i}},hsv2rgb:function(r){var t=6*r.h,o=r.s,e=r.v,i=~~t,n=t-i,s=e*(1-o),c=e*(1-n*o),a=e*(1-(1-n)*o),l=i%6;return{r:[e,c,s,s,a,e][l],g:[a,e,e,c,s,s][l],b:[s,s,a,e,e,c][l]}},hsv2hsl:function(r){var t=(2-r.s)*r.v,o=r.s*r.v;return o=r.s?t<1?t?o/t:0:o/(2-t):0,{h:r.h,s:r.v||o?o:d&&d.hsl&&d.hsl.s||0,l:t/2}},rgb2hsl:function(r,t){var o=_.rgb2hsv(r);return _.hsv2hsl(t?o:d.hsv=o)},hsl2rgb:function(r){var t=6*r.h,o=r.s,e=r.l,i=e<.5?e*(1+o):e+o-o*e,n=e+e-i,s=i?(i-n)/i:0,c=~~t,a=t-c,l=i*s*a,u=n+l,h=i-l,p=c%6;return{r:[i,h,n,n,u,i][p],g:[u,i,i,h,n,n][p],b:[n,n,u,i,i,h][p]}}};return x}(r),R=t(document),z=t(),E="touchmove.tcp mousemove.tcp pointermove.tcp",H="touchstart.tcp mousedown.tcp pointerdown.tcp",D="touchend.tcp mouseup.tcp pointerup.tcp",F=!1,X=r.requestAnimationFrame||r.webkitRequestAnimationFrame||function(r){r()},$='<div class="cp-color-picker"><div class="cp-z-slider"><div class="cp-z-cursor"></div></div><div class="cp-xy-slider"><div class="cp-white"></div><div class="cp-xy-cursor"></div></div><div class="cp-alpha"><div class="cp-alpha-cursor"></div></div></div>',S=".cp-color-picker{position:absolute;overflow:hidden;padding:6px 6px 0;background-color:#444;color:#bbb;font-family:Arial,Helvetica,sans-serif;font-size:12px;font-weight:400;cursor:default;border-radius:5px}.cp-color-picker>div{position:relative;overflow:hidden}.cp-xy-slider{float:left;height:128px;width:128px;margin-bottom:6px;background:linear-gradient(to right,#FFF,rgba(255,255,255,0))}.cp-white{height:100%;width:100%;background:linear-gradient(rgba(0,0,0,0),#000)}.cp-xy-cursor{position:absolute;top:0;width:10px;height:10px;margin:-5px;border:1px solid #fff;border-radius:100%;box-sizing:border-box}.cp-z-slider{float:right;margin-left:6px;height:128px;width:20px;background:linear-gradient(red 0,#f0f 17%,#00f 33%,#0ff 50%,#0f0 67%,#ff0 83%,red 100%)}.cp-z-cursor{position:absolute;margin-top:-4px;width:100%;border:4px solid #fff;border-color:transparent #fff;box-sizing:border-box}.cp-alpha{clear:both;width:100%;height:16px;margin:6px 0;background:linear-gradient(to right,#444,rgba(0,0,0,0))}.cp-alpha-cursor{position:absolute;margin-left:-4px;height:100%;border:4px solid #fff;border-color:#fff transparent;box-sizing:border-box}",A=function(r){v=this.color=new M(r),x=v.options,b=this};A.prototype={render:g,toggle:c};var q=function(o,i){var s=t(o);this.$element=s,i=t.extend({animationSpeed:90,GPU:!0,doRender:!0,customBG:"#FFF",opacity:!0,renderCallback:d,buildCallback:d,body:document.body,scrollResize:!0,gap:4,dark:"#222",light:"#DDD"},i),!b&&i.scrollResize&&t(r).on("resize.tcp scroll.tcp",function(){b.$trigger&&b.toggle.call(b.$trigger[0],!0)}),z=z.add(s),s.colorPicker=b||new A(i),s.options=i,t(i.body).off(".tcp").on(H,function(r){!z.add(y).find(r.target).add(z.filter(r.target))[0]&&c()}),s.on("focusin.tcp click.tcp",function(r){b.color.options=t.extend(b.color.options,x=s.options),c.call(this,r)}).on("change.tcp",function(){v.setColor(this.value||"#FFF"),s.colorPicker.render(!0)}).each(function(){var r=e(this),o=r.split("("),s=n(t(this));s.data("colorMode",o[1]?o[0].substr(0,3):"HEX").attr("readonly",x.preventFocus),i.doRender&&s.css({"background-color":r,color:function(){return v.setColor(r).rgbaMixBGMixCustom.luminance>.22?i.dark:i.light}})})};return q.prototype.hide=function(){c.call(this.$element)},q.prototype.destroy=function(){this.$element.off(".tcp"),this.$element=null},t.fn.colorPicker=function(r){return q(this,r),this},t.fn.colorPicker.destroy=function(){t("*").off(".tcp"),b.toggle(!1),z=t()},q.Colors=M,q});