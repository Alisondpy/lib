define(["jquery"],function(t){"use strict";return function(t,e,n,i){function a(){if(a.result!==i)return a.result;var t,e,s,o,r,l=!1;for(t=n.body||n.documentElement,s=t.style,o="Transition",r=["Moz","Webkit","Khtml","O","ms"],e=0;e<r.length;){if(s[r[e]+o]!==i){l=r[e];break}e++}return a.result=l}function s(t){var e=n.body||n.documentElement;if(t in e.style)return t;var i=t.charAt(0).toUpperCase()+t.substr(1);return a()+i}function o(e,n){this.element=t(e),this.options=t.extend(!0,{},r,n),this.data=t.data(this),this._defaults=r,this._control=null,this._slides=[],this.init()}"function"!=typeof t.data&&(t.data=function(e,n,i){return t(e).data(n,i)});var r,l=e.setTimeout,c=e.clearTimeout,u="undefined"!=typeof TouchEvent,d=s("transition"),f=(s("transform"),s("perspective")),p=function(t,e,n,i){var a;return function(){var s=i||this,o=arguments,r=function(){a=null,n||t.apply(s,o)},u=n&&!a;c(a),a=l(r,e),u&&t.apply(s,o)}},h=function(){var e=/[-_]\D/g,n=function(t){return t.charAt(1).toUpperCase()},a=function(t){return t.replace(e,n)},o={duration:1,delay:1,timingFunction:1},r={transform:f?function(t){return"string"==typeof t?t:(t.x=t.x||0,t.y=t.y||0,t.z=t.z||0,"translate3d("+t.x+"px, "+t.y+"px, "+t.z+"px)")}:function(t){return"string"==typeof t?t:(t.x=t.x||0,t.y=t.y||0,"translate("+t.x+"px, "+t.y+"px)")}};return function(e,n,l,c){e=t(e),c=c===i||c,"boolean"==typeof l&&(c=l,l=null);var u=e[0].style,d=[],f={},p=function(t){return t=a(t),o[t]&&(t="transition"+t.charAt(0).toUpperCase()+t.substr(1)),s(t)},h=function(t,e){r[t]&&(e=r[t](e)),t=p(t),u[t]=e,d.push(t)};if(l||c){var v="transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd";e.on(v,function t(n){e.off(v,t);var i=d.length;if(l&&l(n),c)for(;i--;)u[d[i]]=""})}for(var y in n)n.hasOwnProperty(y)&&(f[y]=1,h(y,n[y]));var m="timing-function";f.duration&&!f[m]&&h(m,"ease-in-out")}}(),v=function(e,n){e=e||{};var i=t(e),a=Array.prototype.slice;return n=n||e.name,t.each({on:"on",un:"off",once:"one",emit:"trigger"},function(t,s){e[t]=function(e){var o=a.call(arguments,0),r=o[1];return n&&!~e.indexOf(".")&&(o[0]=e+"."+n),"function"==typeof r&&("on"===t?o[1]=r.__||(r.__=function(t){return r.apply(this,a.call(arguments,1))}):"un"===t&&(o[1]=r.__)),i[s].apply(i,o)}}),e},y="slider";return r={width:940,height:528,autoScale:!1,start:0,cls:{item:"ui-slider-slide",active:"ui-slider-i-on"},lazyLoad:{enable:!0,attr:"data-src",loadingClass:"ui-slider-img-loading"},navigation:{arrows:!0,toggleOnHover:!1,effect:"slide",nextArrow:'<a href="#" class="ui-slider-navigation ui-slider-next" title="Next">Next</a>',prevArrow:'<a href="#" class="ui-slider-navigation ui-slider-prev" title="Previous">Previous</a>'},pagination:{active:!0,effect:"slide"},play:{active:!1,effect:"slide",interval:5e3,auto:!1,swap:!0,pauseOnHover:!0,restartDelay:2500},effect:{slide:{speed:500},fade:{speed:300,crossfade:!0}},callback:{loaded:function(){},start:function(){},complete:function(){}}},t.extend(o.prototype,{init:function(){var n,i,a,s,o,r,l=this,c=l.element,d=l.options,f=l.data;f.animating=!1,f.total=r=c.children().not(".ui-slider-navigation",c).length,f.current=d.start,u&&(d.effect.slide.speed=d.effect.slide.speed/2),v(l,"slide"),c.css({overflow:"hidden"}).addClass("ui-slider"),c.children().not(".ui-slider-navigation",c).wrapAll('<div class="ui-slider-container">',c).parent().css({overflow:"hidden",position:"relative"}),t(".ui-slider-container",c).wrapInner('<div class="ui-slider-control">',c);var h=l._control=t(".ui-slider-control",c),y=l._slides=h.children();h.css({position:"relative",left:0}),y.addClass(d.cls.item).css({position:"absolute",top:0,left:0,width:"100%",zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"}).each(function(e,n){t(n).attr("data-slide-idx",e)}),c.show(),l.update(),d.lazyLoad.enable&&l.lazyLoad().on("slide",function(t,e){l.lazyLoad()}),u&&(l._setuptouch(),h.on("touchstart",function(t){l._touchstart(t)}).on("touchmove",function(t){l._touchmove(t)}).on("touchend",function(t){l._touchend(t)}));var m=d.navigation;if(m.arrows&&(n=c.find(".ui-slider-prev"),i=c.find(".ui-slider-next"),n.length||(n=t(m.prevArrow).appendTo(c)),i.length||(i=t(m.nextArrow).appendTo(c))),n.click(function(t){t.preventDefault(),l.prev()}),i.click(function(t){t.preventDefault(),l.next()}),m.toggleOnHover){var g=i.show().width(),_=n.show().width(),x=function(t,e){var a=+!!t,s={right:-1*!a*g,opacity:a},o={left:-1*!a*_,opacity:a};e?(i.animate(s,200),n.animate(o,200)):(i.css(s),n.css(o))};x(!1),c.on("mouseenter",function(t){x(!0,!0)}).on("mouseleave",function(t){x(!1,!0)})}if(d.play.active&&(s=t('<a href="#" class="ui-slider-navigation ui-slider-play" title="Play">Play</a>').appendTo(c),o=t('<a href="#" class="ui-slider-navigation ui-slider-stop" title="Stop" style="display:'+(d.play.swap?"none":"")+'">Stop</a>').appendTo(c),s.click(function(t){t.preventDefault(),l.play(!0)}),o.click(function(t){t.preventDefault(),l.stop(!0)})),r>1&&d.pagination.active){a=t('<ul class="ui-slider-pagination" />').appendTo(c).on("click","[data-slide-idx]",function(e){e.preventDefault(),l.go(+t(e.currentTarget).attr("data-slide-idx"))});for(var w=-1;++w<r;)t('<li class="ui-slider-pagination-item"><a href="#" data-slide-idx="'+w+'">'+(w+1)+"</a></li>").appendTo(a)}var b=p(function(){return f.animating?b():void l.update()},100);t(e).on("resize",b),l.once("destroy",function(){t(e).off("resize",b)}),l._setActive();var T=d.play.auto;T&&l.play(),l.on("slide",function(t,e){var n=t.next;d.callback.complete(n,y[n]),T&&l.play()}),d.callback.loaded(d.start)},lazyLoad:function(){function e(e){var i=t(e).find("["+s+"]").get();i.unshift(e),t(i).each(function(e,n){var i=n.tagName.toLowerCase(),a=t(n),r=a.attr(s),l=new Image;r&&n.src!==r&&(l.onload=function(){l=l.onload=null,a.animate({opacity:0},100,function(){"img"===i?a.attr("src",r):a.css("background-image","url("+r+")"),a.animate({opacity:1},200,function(){a.removeAttr(s).removeClass(o)})})},l.src=r)}),n.emit("loadSlide",e)}var n=this,i=n.options.lazyLoad,a=n._slides,s=i.attr||"data-src",o=i.loadingClass;return t.each(n._cursor(),function(t,n){e(a[n])}),n},_setActive:function(e){var n,i;n=this.element,i=e>-1?e:this.data.current,t(".active",n).removeClass("active"),t(t(".ui-slider-pagination li",n)[i]).find("a").addClass("active")},update:function(){var e,n,i=this.element,a=this.options,s=this.data.current,o=this._control;if(!this.data.animating)return this._slides.each(function(e,n){e===s?t(n).css({display:"block",zIndex:1}).addClass(a.cls.active):t(n).css({display:"none",left:0,zIndex:0})}),e=i.width()||a.width,n=i.height()||a.height,a.autoScale&&(n=a.height/a.width*e),a.width=e,a.height=n,o.css({width:e+"px",height:n+"px",lineHeight:n+"px"}),t(".ui-slider-container",i).css({width:e+"px",height:n+"px"}),this},next:function(t){return this.data.direction="next",this._transition(t)},prev:function(t){return this.data.direction="prev",this._transition(t)},_transition:function(t,e,n){return this.data.animating||(this.stop(),"number"!=typeof t&&(n=e,e=t,t=-1),"function"==typeof e&&(n=e,e=""),e=e||this.options.navigation.effect,"fade"===e?this._fade(t,n):this._slide(t,n)),this},go:function(t){var e=this.data.total;return t>e-1?t=e-1:t<0&&(t=0),this._transition(t)},_cursor:function(t){var e=this.data,n=t||e.current,i=e.total,a=i-1,s=n+1,o=n-1;return o<0&&(o=a),s>a&&(s=0),{current:n,prev:o,next:s}},_setuptouch:function(){var e=this.options.width,n=this._slides,i=this._cursor(),a=i.prev,s=i.next;s!==a?(t(n[s]).css({display:"block",left:e}),t(n[a]).css({display:"block",left:-1*e})):t(n[s]).css({display:"block"})},_touchstart:function(t){this.stop();var e,n,i,a=this.data;e=(t.originalEvent||t).touches[0],this._setuptouch(),n=e.pageX,i=e.pageY,e=a.touches={startX:n,startY:i,scroll:null,time:+new Date},e.start=e.current=n,t.stopPropagation()},_touchend:function(t){var e,n,i,a,s=this,o=s.options,r=s.data,l=this._control,c=r.touches,u=o.width;t.stopPropagation(),c.scroll||(e=+new Date-c.time,n=c.current-c.start,i=Math.abs(n),r.total>1&&(i>.4*u||i>.1*u&&e<300)?(a=n<0?"next":"prev",r.direction=a,s._slide()):h(l,{transform:{x:0,y:0},duration:.85*o.effect.slide.speed+"ms"}))},_touchmove:function(t){var e=this.data,n=!0,i=(t.originalEvent||t).touches[0],a=e.touches,s=i.pageX,o=i.pageY,r=a.scroll;null===r&&n&&(r=!!(r||Math.abs(o-a.startY)>Math.abs(s-a.startX))),null!==r||n||(r=!!(r||Math.abs(o-a.startY)<Math.abs(s-a.startX))),t.stopPropagation(),a.current=s,a.scroll=r,e.animating||r||(t.preventDefault(),h(this._control,{"timing-function":"linear",transform:{x:s-a.startX,y:0}},!1))},play:function(e){var n=this,i=n.options,a=n.data,s=n.element,o=i.play.interval;return a.total>1&&!a.playInterval&&(e&&(a.direction="next",n._transition()),a.playInterval=l(function t(){a.direction="next",a.playInterval=null,n._transition(function(){a.stoped||(a.playInterval=l(t,o))})},o),i.play.pauseOnHover&&(a._restartTimer&&(c(a._restartTimer),a._restartTimer=null),t(".ui-slider-container",s).off().on("mouseenter",function(t){a.stoped&&!a._restartTimer||n.stop()}).on("mouseleave",function(e){if(!t.contains(n.element[0],e.toElement)){var s,o=i.play.restartDelay;o?((s=a._restartTimer)&&c(s),a._restartTimer=l(function(){n.play(!0)},o)):n.play()}})),a.stoped=!1,t(".ui-slider-play",s).addClass("ui-slider-playing"),i.play.swap&&(t(".ui-slider-play",s).hide(),t(".ui-slider-stop",s).show())),n},stop:function(e){var n=this.element,i=this.data;return i._restartTimer&&(c(i._restartTimer),i._restartTimer=null),i.playInterval&&(c(i.playInterval),i.playInterval=null),i.stoped=!0,t(".ui-slider-play",n).removeClass("ui-slider-playing"),this.options.play.swap&&(t(".ui-slider-stop",n).hide(),t(".ui-slider-play",n).show()),this},_slide:function(e,n){var i,a,s,o,r=this,l=r.data,c=r.options,f=(r.element,r._control),p=r._slides,v=c.callback;if("function"==typeof e&&(n=e,e=-1),!l.animating&&e!==l.current){l.animating=!0,i=l.current,"number"==typeof e&&e>-1?(o=e>i?1:-1,s=e):(o="next"===l.direction?1:-1,s=i+o),a=c.width*(-1*o),s===-1&&(s=l.total-1),s===l.total&&(s=0),this._setActive(s),e>-1&&p.each(function(e,n){e!==i&&t(n).css({display:"none",left:0,zIndex:0})}),t(p[s]).css({display:"block",left:o*c.width,zIndex:1}),v.start(s,p[s]);var y=function(){var e=c.cls.active;t(p[s]).css({left:0}).addClass(e),t(p[i]).css({display:"none",left:0,zIndex:0}).removeClass(e),l.stoped=!1,l.current=s,l.animating=!1,n&&n(),r.emit("slide",[r._cursor(),p[s]])},m=c.effect.slide.speed;d?h(f,{transform:{x:a,y:0},duration:m+"ms"},function(e){p.each(function(e,n){e!==s&&t(n).css({display:"none",left:0,zIndex:0})}),y(),u&&r._setuptouch()}):f.stop().animate({left:a},m,function(){f.css({left:0}),y()})}},_fade:function(e,n){var i,a,s,o=this,r=o.options,l=o.data,c=o._slides,u=r.callback;if(!l.animating&&e!==l.current){l.animating=!0,i=l.current,"number"==typeof e&&e>-1?(s=e>i?1:-1,a=e):(s="next"===l.direction?1:-1,a=i+s),a===-1&&(a=l.total-1),a===l.total&&(a=0),this._setActive(a),t(c[a]).css({display:"none",left:0,zIndex:1}),u.start(a,c[a]);var d=function(){var e=r.cls.active;t(c[a]).addClass(e),t(c[i]).removeClass(e),l.stoped=!1,l.current=a,l.animating=!1,n&&n(),o.emit("slide",[o._cursor(),c[a]])},f=r.effect.fade.speed;r.effect.fade.crossfade?(t(c[i]).stop().fadeOut(f),t(c[a]).stop().fadeIn(f,function(){t(c[a]).css({zIndex:0}),d()})):t(c[i]).stop().fadeOut(f,function(){t(c[a]).stop().fadeIn(f,function(){t(c[a]).css({zIndex:1})}),d()})}},destroy:function(){var e=this.element;t(".ui-slider-container",e).off(),this.stop(!0),this._control.off(),this.emit("destroy")}}),t.fn[y]=function(e){return this.each(function(){if(!t.data(this,"plugin_"+y))return t.data(this,"plugin_"+y,new o(this,e))})},o}(t,window,document)});