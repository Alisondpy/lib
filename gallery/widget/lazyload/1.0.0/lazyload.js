define(function(e,t,i){"use strict";function r(e,t){t=a.extend(!0,{threshold:~~(d.height()/3),optimizeImage:!1},t);var i=t.type||u;t.optimizeImage&&i===u&&(t.sourceMaker=g),n.apply(this,[e,t])}var a=e("jquery"),l=e("../../../../core/1.0.0/utils/util"),n=e("../../../../plugins/lazyload/1.9.3/lazyload"),o=e("../../../utils/1.0.0/image").rebuildImageURL,s=2,u="image",d=a(window),g=function(e,t){return o(e,s)};l.inherits(r,n),r.load=function(e,t){t=t||0;var i=t.dataAttribute||"url",r="data-"+i,l=t.loadingClass||"img-error",o=a(e).filter("["+r+"]");if(o.length){var s=new n(o,a.extend(!0,{threshold:~~(d.height()/3),dataAttribute:i,loadingClass:l,placeholder:"//s1.zhongzhihui.com/lib/assets/images/s.gif"},t));return s.on("reset",function(){s.destroy(),s=null,o.removeAttr(r).removeClass(l),o=null}),s.on("lazyItemReady",function(e){e.removeAttribute(r),s.peek()||s.reset()}),s.update(),s}},i.exports=r});